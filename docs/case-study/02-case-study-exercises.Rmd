---
  title: "Day 1 Case Study Exercises"
output: github_document
---
  
```{r setup, include = FALSE}
knitr::opts_chunk$set(
  eval = FALSE,
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  collapse = TRUE
)
```

## Project set up

1. Create a new project

2. Create a new .Rmd report. You can copy the text from this file into your .Rmd file and add your own notes and code as you see fit.

3. Copy the `Month-XX.csv` files from your class folder (or yesterday's project) to this project location.

4. Load the __tidyverse__ package.

```{r}
library(tidyverse)
```


## Analysis questions

5. Import the `Month-XX.csv` files into your current R session.  Do so using a `for` loop or ___purrr___.  Rather than have 11 separate data frames (one for each month), combines these so that you have one data frame containing all the data.  You final data frame should have 698,159 rows and 10 columns.

```{r importing-data}
# import all data files into one data frame titled "df"
df <- list.files("../data") %>%
  paste0("../data/", .) %>%
  map_dfr(read_csv)

glimpse(df)
```

6. Check the current class of each column.

```{r}
df %>% map(class)
```

7. How many unique values exists in each column?

```{r}
df %>% map_int(n_distinct)
```

8. Use `mutate()` and `ifelse()` (or `if_else()`) to modify the `Factor_A` variable. Change those observations that have the following values to:

| Current values | Change to |
| :------------: | :-------: |
| `0, 2, 7, 8`   | "low"     |
| `10, 15, 16`   | "high"    |

```{r}
df <- df %>%
  mutate(Factor_A = if_else(Factor_A %in% c(0, 2, 7, 8), "low", "high"))
```

9. Create a function that converts monthly values to quarters.  Do it such that:

- Jan-Mar = Q1
- Apr-Jun = Q2
- Jul-Sep = Q3
- Oct-Dec = Q4

Be sure to include a `stop()` error in the function that stops execution if the input is not a character atomic vector.  Also, think about how you want to deal with NAs or entries that are not a missing value.

```{r}
convert_to_qtr <- function(x) {
  
  # make sure x is a character atomic vector
  stopifnot(is.atomic(x), is.character(x))
  
  dplyr::case_when(
    x %in% c("Jan", "Feb", "Mar") ~ "Q1",
    x %in% c("Apr", "May", "Jun") ~ "Q2",
    x %in% c("Jul", "Aug", "Sep") ~ "Q3",
    x %in% c("Oct", "Nov", "Dec") ~ "Q4", 
    TRUE                          ~ NA_character_
  )
}
```

10. Use the function you created above in a `mutate()` statement to create a new variable called "Qtr" in the __df__ data frame.

```{r}
df <- df %>%
  mutate(Qtr = convert_to_qtr(Month))

glimpse(df)
```


